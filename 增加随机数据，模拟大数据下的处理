------增加随机项目

DROP TABLE APPOINTMENT_2;
CREATE TABLE APPOINTMENT_2 AS SELECT * FROM APPOINTMENT;

CREATE OR REPLACE PROCEDURE DUPLICATE_APPOINTMENT 
IS
  I NUMBER := 1;
BEGIN
   FOR I IN 1 .. 100 LOOP
   INSERT INTO APPOINTMENT_2 VALUES(TRUNC(dbms_random.value(00000001,99999999)),
                                 TRUNC(dbms_random.value(100000000,100099999)),
                                 TRUNC(dbms_random.value(001,999)),
                                 TRUNC(dbms_random.value(1,9)),
                                     TO_DATE(TRUNC(DBMS_RANDOM.VALUE(2458850,2459120)),'J')+ DBMS_RANDOM.VALUE(1, 1 * 24 * 60 * 60)/ 3600 / 24,
                                     null,
                                     dbms_random.string('U',1));
   END LOOP;
   COMMIT;
   UPDATE APPOINTMENT_2 SET END_DT_TIME =START_DT_TIME + DBMS_RANDOM.VALUE(0, 3 * 60 * 60)/ 3600 / 3 WHERE END_DT_TIME IS NULL;  /*within 3 hrs*/
END;

---调用
BEGIN
  DUPLICATE_APPOINTMENT;
END;



--------建立组合索引：在数据量较大的情况下，当一些搜索组合常出现的时候，建立一个组合索引方便快捷查询：
SELECT * FROM APPOINTMENT_2;

CREATE INDEX U_APPOINT_NURSE_PHYSICIAN ON APPOINTMENT_2(APPOINTMENTID,PHYSICIAN);




--------建立分区：在数据量较大的情况下，对表格进行分区优化，提高效率：
DROP TABLE APPOINTMENT_PART;

CREATE TABLE APPOINTMENT_PART 
(
APPOINTMENTID NUMBER PRIMARY KEY, 
PATIENT NUMBER, 
PREPNURSE NUMBER,  
PHYSICIAN NUMBER, 
START_DT_TIME DATE, 
END_DT_TIME DATE, 
EXAMINATIONROOM VARCHAR2(1))
PARTITION BY LIST (PHYSICIAN)
(
    PARTITION APPOINTMENT_PART_1 VALUES(1),
    PARTITION APPOINTMENT_PART_2 VALUES(2),    
    PARTITION APPOINTMENT_PART_3 VALUES(3),
    PARTITION APPOINTMENT_PART_4 VALUES(4),
    PARTITION APPOINTMENT_PART_5 VALUES(5),
    PARTITION APPOINTMENT_PART_6 VALUES(6),
    PARTITION APPOINTMENT_PART_7 VALUES(7),
    PARTITION APPOINTMENT_PART_8 VALUES(8),
    PARTITION APPOINTMENT_PART_9 VALUES(9)
);

INSERT INTO APPOINTMENT_PART SELECT * FROM APPOINTMENT_2;


SELECT * FROM APPOINTMENT_PART PARTITION(APPOINTMENT_PART_3);

